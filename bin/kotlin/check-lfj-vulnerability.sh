#!/bin/bash
set -eu
KOTLIN_SERVICES=${1:?"missing arg 1 for KOTLIN_SERVICES"}

FILE="/Users/connorglynn/git/scripts/services/kotlin/$KOTLIN_SERVICES.txt"

for service in $(cat "$FILE"); do
  source git-checkout-clean-main.sh "$service"

  echo "Checking lfj vulnerabilities for $service"
  ./gradlew dependencies | grep log4j-core || echo "$service: not directly dependent on log4j-core"

  echo "---------------------------------------------------------------"
done
